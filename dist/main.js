var t=Object.defineProperty,e=(e,n,o)=>(((e,n,o)=>{n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o})(e,"symbol"!=typeof n?n+"":n,o),o);function n(t){!function(t){t.select();var e=window.mainWorkspace,n=t.getRelativeToSurfaceXY(),o=e.getMetrics();e.scrollbar.set(n.x*e.scale-o.contentLeft-o.viewWidth,n.y*e.scale-o.contentTop-.1*o.viewHeight)}(window.mainWorkspace.getBlockById(t))}function o(){const t=$(".collapsedRuleInnerContainer");t.length&&async function(){const t=[];let e=window.modBlock.getChildren(!1)[0];for(;e;)t.push(e),e=e.nextConnection.targetBlock();return t}().then((e=>{t.children(".collapsedRule").remove(),e.forEach(((e,o)=>{const r=$("<div>",{class:"collapsedRule","data-block-id":e.id}).append($("<div>").text(o+1)).append($("<div>").text(function(t){if("ruleBlock"===t.type)return t.inputList[0].fieldRow[1].getValue()}(e)));r.on("click touch",(function(){n(this.getAttribute("data-block-id"))})),r.appendTo(t)}))}))}function r(){function t(){lt.info("Starting Rules list plugin..."),window.mainWorkspace.addChangeListener((function(t){if(t.type==window.Blockly.Events.BLOCK_MOVE){const e=window.mainWorkspace.getBlockById(t.blockId);e&&"ruleBlock"===e.type&&o()}})),o()}lt.info("Adding left plugin pannel");const e=$("<div></div>").load(at.getUrl("html/leftPluginPane.html"),(function(){$(".blocklyScrollbarHorizontal").after(e.html())}));let n;var r;(r="#leftPluginPage",new Promise((t=>{if(document.querySelector(r))return t(document.querySelector(r));const e=new MutationObserver((n=>{document.querySelector(r)&&(t(document.querySelector(r)),e.disconnect())}));e.observe(document.body,{childList:!0,subtree:!0})}))).then((function(e){const o=$(":root");o.css("--leftPageMarginLeft",`${$(".blocklyToolboxDiv").width()}px`),o.css("--collapsed-rule-bg-image-url",`url(${at.getUrl("static/images/rule_collapsed_no_name.svg")})`),o.css("--left-arrow-svg-url",`url(${at.getUrl("static/images/left_arrow.svg")})`),t(),n=$("#leftPaneOpenIconContainer")})),window.addEventListener("flyout_show_event",(function(t){n&&n.hide(0)})),window.addEventListener("flyout_hide_event",(function(t){n&&n.show(0)}))}
/*! PlainDraggable v2.5.14 (c) anseki https://anseki.github.io/plain-draggable/ */
var i=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n.r(e);var o,r=[],i=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},a=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return clearTimeout(t)},l=Date.now();function s(){var t,e;o&&(a.call(window,o),o=null),r.forEach((function(e){var n;(n=e.event)&&(e.event=null,e.listener(n),t=!0)})),t?(l=Date.now(),e=!0):Date.now()-l<500&&(e=!0),e&&(o=i.call(window,s))}function c(t){var e=-1;return r.some((function(n,o){return n.listener===t&&(e=o,!0)})),e}var u=function(t){var e;return-1===c(t)?(r.push(e={listener:t}),function(t){e.event=t,o||s()}):null};function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var f=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){f=!0}}))}catch(ne){}function p(t,e,n,o){t.addEventListener(e,n,f?o:o.capture)}function h(t,e){if(null!=t&&null!=e)for(var n=0;n<t.length;n++)if(t[n].identifier===e)return t[n];return null}function g(t){return t&&"number"==typeof t.clientX&&"number"==typeof t.clientY}function m(t){t.preventDefault()}var y=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startHandlers={},this.lastHandlerId=0,this.curPointerClass=null,this.curTouchId=null,this.lastPointerXY={clientX:0,clientY:0},this.lastTouchTime=0,this.options={preventDefault:!0,stopPropagation:!0},e&&["preventDefault","stopPropagation"].forEach((function(t){"boolean"==typeof e[t]&&(n.options[t]=e[t])}))}var e,n,o;return e=t,o=[{key:"addEventListenerWithOptions",get:function(){return p}}],(n=[{key:"regStartHandler",value:function(t){var e=this;return e.startHandlers[++e.lastHandlerId]=function(n){var o,r,i="mousedown"===n.type?"mouse":"touch",a=Date.now();if("touch"===i)e.lastTouchTime=a,o=n.changedTouches[0],r=n.changedTouches[0].identifier;else{if(a-e.lastTouchTime<400)return;o=n}if(!g(o))throw new Error("No clientX/clientY");e.curPointerClass&&e.cancel(),t.call(e,o)&&(e.curPointerClass=i,e.curTouchId="touch"===i?r:null,e.lastPointerXY.clientX=o.clientX,e.lastPointerXY.clientY=o.clientY,e.options.preventDefault&&n.preventDefault(),e.options.stopPropagation&&n.stopPropagation())},e.lastHandlerId}},{key:"unregStartHandler",value:function(t){delete this.startHandlers[t]}},{key:"addStartHandler",value:function(t,e){if(!this.startHandlers[e])throw new Error("Invalid handlerId: ".concat(e));return p(t,"mousedown",this.startHandlers[e],{capture:!1,passive:!1}),p(t,"touchstart",this.startHandlers[e],{capture:!1,passive:!1}),p(t,"dragstart",m,{capture:!1,passive:!1}),e}},{key:"removeStartHandler",value:function(t,e){if(!this.startHandlers[e])throw new Error("Invalid handlerId: ".concat(e));return t.removeEventListener("mousedown",this.startHandlers[e],!1),t.removeEventListener("touchstart",this.startHandlers[e],!1),t.removeEventListener("dragstart",m,!1),e}},{key:"addMoveHandler",value:function(t,e){var n=this,o=u((function(t){var e="mousemove"===t.type?"mouse":"touch";if("touch"===e&&(n.lastTouchTime=Date.now()),e===n.curPointerClass){var o="touch"===e?h(t.changedTouches,n.curTouchId):t;g(o)&&(o.clientX===n.lastPointerXY.clientX&&o.clientY===n.lastPointerXY.clientY||n.move(o),n.options.preventDefault&&t.preventDefault(),n.options.stopPropagation&&t.stopPropagation())}}));p(t,"mousemove",o,{capture:!1,passive:!1}),p(t,"touchmove",o,{capture:!1,passive:!1}),n.curMoveHandler=e}},{key:"move",value:function(t){g(t)&&(this.lastPointerXY.clientX=t.clientX,this.lastPointerXY.clientY=t.clientY),this.curMoveHandler&&this.curMoveHandler(this.lastPointerXY)}},{key:"addEndHandler",value:function(t,e){var n=this;function o(t){var e="mouseup"===t.type?"mouse":"touch";if("touch"===e&&(n.lastTouchTime=Date.now()),e===n.curPointerClass){var o="touch"===e?h(t.changedTouches,n.curTouchId)||(h(t.touches,n.curTouchId)?null:{}):t;o&&(n.end(o),n.options.preventDefault&&t.preventDefault(),n.options.stopPropagation&&t.stopPropagation())}}p(t,"mouseup",o,{capture:!1,passive:!1}),p(t,"touchend",o,{capture:!1,passive:!1}),n.curEndHandler=e}},{key:"end",value:function(t){g(t)&&(this.lastPointerXY.clientX=t.clientX,this.lastPointerXY.clientY=t.clientY),this.curEndHandler&&this.curEndHandler(this.lastPointerXY),this.curPointerClass=this.curTouchId=null}},{key:"addCancelHandler",value:function(t,e){var n=this;p(t,"touchcancel",(function(t){n.lastTouchTime=Date.now(),null!=n.curPointerClass&&(h(t.changedTouches,n.curTouchId)||!h(t.touches,n.curTouchId))&&n.cancel()}),{capture:!1,passive:!1}),n.curCancelHandler=e}},{key:"cancel",value:function(){this.curCancelHandler&&this.curCancelHandler(),this.curPointerClass=this.curTouchId=null}}])&&d(e.prototype,n),o&&d(e,o),t}();function v(t){return t.substr(0,1).toUpperCase()+t.substr(1)}var w,b,x,S,E=["webkit","moz","ms","o"],_=E.reduce((function(t,e){return t.push(e),t.push(v(e)),t}),[]),k=E.map((function(t){return"-".concat(t,"-")})),T=function(){return S=S||document.createElement("div").style},L=(b=new RegExp("^(?:"+E.join("|")+")(.)","i"),x=/[A-Z]/,function(t){return"float"===(t=(t+"").replace(/\s/g,"").replace(/-([\da-z])/gi,(function(t,e){return e.toUpperCase()})).replace(b,(function(t,e){return x.test(e)?e.toLowerCase():t}))).toLowerCase()?"cssFloat":t}),O=(w=new RegExp("^(?:"+k.join("|")+")","i"),function(t){return(null!=t?t+"":"").replace(/\s/g,"").replace(w,"")}),B=function(t,e){var n=T();return t=t.replace(/[A-Z]/g,(function(t){return"-".concat(t.toLowerCase())})),n.setProperty(t,e),null!=n[t]&&n.getPropertyValue(t)===e},C={},P={};function A(t){if((t=L(t))&&null==C[t]){var e=T();if(null!=e[t])C[t]=t;else{var n=v(t);_.some((function(o){var r=o+n;return null!=e[r]&&(C[t]=r,!0)}))||(C[t]=!1)}}return C[t]||void 0}var I={getName:A,getValue:function(t,e){var n;return(t=A(t))?(P[t]=P[t]||{},(Array.isArray(e)?e:[e]).some((function(e){return e=O(e),null!=P[t][e]?!1!==P[t][e]&&(n=P[t][e],!0):B(t,e)?(n=P[t][e]=e,!0):!!k.some((function(o){var r=o+e;return!!B(t,r)&&(n=P[t][e]=r,!0)}))||(P[t][e]=!1,!1)})),"string"==typeof n?n:void 0):n}};function j(t){return(t+"").trim()}function R(t,e){e.setAttribute("class",t.join(" "))}function N(t,e,n){n.filter((function(e){return!(!(e=j(e))||-1!==t.indexOf(e)||(t.push(e),0))})).length&&R(t,e)}function F(t,e,n){n.filter((function(e){var n;return!(!(e=j(e))||-1===(n=t.indexOf(e))||(t.splice(n,1),0))})).length&&R(t,e)}function M(t){return!M.ignoreNative&&t.classList||(e=(t.getAttribute("class")||"").trim().split(/\s+/).filter((function(t){return!!t})),n={length:e.length,item:function(t){return e[t]},contains:function(t){return-1!==e.indexOf(j(t))},add:function(){return N(e,t,Array.prototype.slice.call(arguments)),M.methodChain?n:void 0},remove:function(){return F(e,t,Array.prototype.slice.call(arguments)),M.methodChain?n:void 0},toggle:function(n,o){return i=t,a=n,l=o,-1!==(s=(r=e).indexOf(a=j(a)))?!!l||(r.splice(s,1),R(r,i),!1):!1!==l&&(r.push(a),R(r,i),!0);var r,i,a,l,s},replace:function(o,r){return i=e,a=t,s=r,(l=j(l=o))&&(s=j(s))&&l!==s&&-1!==(c=i.indexOf(l))&&(i.splice(c,1),-1===i.indexOf(s)&&i.push(s),R(i,a)),M.methodChain?n:void 0;var i,a,l,s,c}});var e,n}M.methodChain=!0;var D=M;function $(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}D.ignoreNative=!0;var W,Y,z,U,X,G,V,q,K,Z,J,Q,tt,et=["tl","tr","bl","br"],nt=["start","end"],ot=["inside","outside"],rt=[40,200,1e3],it=[100,40,0],at="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style&&!window.navigator.msPointerEnabled,lt=!at&&!!document.uniqueID,st="MozAppearance"in document.documentElement.style,ct=!(at||st||!window.chrome||!window.CSS),ut=!(at||lt||st||ct||window.chrome||!("WebkitAppearance"in document.documentElement.style)),dt=(W={}.toString,Y={}.hasOwnProperty.toString,z=Y.call(Object),function(t){var e,n;return t&&"[object Object]"===W.call(t)&&(!(e=Object.getPrototypeOf(t))||(n=e.hasOwnProperty("constructor")&&e.constructor)&&"function"==typeof n&&Y.call(n)===z)}),ft=Number.isFinite||function(t){return"number"==typeof t&&window.isFinite(t)},pt={},ht={},gt=new y,mt=0,yt=ut?["all-scroll","move"]:["grab","all-scroll","move"],vt=ut?"move":["grabbing","move"],wt="plain-draggable",bt="plain-draggable-dragging",xt="plain-draggable-moving",St={},Et=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},_t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return clearTimeout(t)};{let t=function(){var t=Date.now();["x","y"].forEach((function(e){var n=Ot[e];if(n){var o=t-n.lastFrameTime,r=Tt(kt,e),i=null!=n.lastValue&&Math.abs(n.lastValue-r)<10?n.lastValue:r;if(-1===n.dir?i>n.min:i<n.max){var a=i+n.speed*o*n.dir;a<n.min?a=n.min:a>n.max&&(a=n.max),Tt(kt,e,a),n.lastValue=a}n.lastFrameTime=t}}))},e=function(){_t.call(window,Lt),t(),Lt=Et.call(window,e)};var kt,Tt,Lt,Ot={};St.move=function(n,o,r){_t.call(window,Lt),t(),kt===n&&(o.x&&Ot.x&&(o.x.lastValue=Ot.x.lastValue),o.y&&Ot.y&&(o.y.lastValue=Ot.y.lastValue)),kt=n,Ot=o,Tt=r;var i=Date.now();["x","y"].forEach((function(t){var e=Ot[t];e&&(e.lastFrameTime=i)})),Lt=Et.call(window,e)},St.stop=function(){_t.call(window,Lt),t(),Ot={},kt=null}}function Bt(t,e,n){return null!=n&&("x"===e?t.scrollTo(n,t.pageYOffset):t.scrollTo(t.pageXOffset,n)),"x"===e?t.pageXOffset:t.pageYOffset}function Ct(t,e,n){var o="x"===e?"scrollLeft":"scrollTop";return null!=n&&(t[o]=n),t[o]}function Pt(t){return t?dt(t)?Object.keys(t).reduce((function(e,n){return e[n]=Pt(t[n]),e}),{}):Array.isArray(t)?t.map(Pt):t:t}function At(t,e){var n,o;return H(t)!==H(e)||(n=dt(t)?"obj":Array.isArray(t)?"array":"")!=(dt(e)?"obj":Array.isArray(e)?"array":"")||("obj"===n?At(o=Object.keys(t).sort(),Object.keys(e).sort())||o.some((function(n){return At(t[n],e[n])})):"array"===n?t.length!==e.length||t.some((function(t,n){return At(t,e[n])})):t!==e)}function It(t){return!(!t||t.nodeType!==Node.ELEMENT_NODE||"function"!=typeof t.getBoundingClientRect||t.compareDocumentPosition(document)&Node.DOCUMENT_POSITION_DISCONNECTED)}function jt(t){if(!dt(t))return null;var e;if(!ft(e=t.left)&&!ft(e=t.x))return null;if(t.left=t.x=e,!ft(e=t.top)&&!ft(e=t.y))return null;if(t.top=t.y=e,ft(t.width)&&t.width>=0)t.right=t.left+t.width;else{if(!(ft(t.right)&&t.right>=t.left))return null;t.width=t.right-t.left}if(ft(t.height)&&t.height>=0)t.bottom=t.top+t.height;else{if(!(ft(t.bottom)&&t.bottom>=t.top))return null;t.height=t.bottom-t.top}return t}function Rt(t){return ft(t)?{value:t,isRatio:!1}:"string"==typeof t?(e=t.replace(/\s/g,""),(r=/^(.+?)(%)?$/.exec(e))&&ft(n=parseFloat(r[1]))?{value:(o=!(!r[2]||!n))?n/100:n,isRatio:o}:null):null;var e,n,o,r}function Nt(t){return t.isRatio?"".concat(100*t.value,"%"):t.value}function Ft(t,e,n){return"number"==typeof t?t:e+t.value*(t.isRatio?n:1)}function Mt(t){if(!dt(t))return null;var e;if(!(e=Rt(t.left))&&!(e=Rt(t.x)))return null;if(t.left=t.x=e,!(e=Rt(t.top))&&!(e=Rt(t.y)))return null;if(t.top=t.y=e,(e=Rt(t.width))&&e.value>=0)t.width=e,delete t.right;else{if(!(e=Rt(t.right)))return null;t.right=e,delete t.width}if((e=Rt(t.height))&&e.value>=0)t.height=e,delete t.bottom;else{if(!(e=Rt(t.bottom)))return null;t.bottom=e,delete t.height}return t}function Dt(t){return Object.keys(t).reduce((function(e,n){return e[n]=Nt(t[n]),e}),{})}function $t(t,e){var n={left:"x",right:"x",x:"x",width:"x",top:"y",bottom:"y",y:"y",height:"y"},o={x:e.left,y:e.top},r={x:e.width,y:e.height};return jt(Object.keys(t).reduce((function(e,i){return e[i]=Ft(t[i],"width"===i||"height"===i?0:o[n[i]],r[n[i]]),e}),{}))}function Ht(t,e){var n=t.getBoundingClientRect(),o={left:n.left,top:n.top,width:n.width,height:n.height};if(o.left+=window.pageXOffset,o.top+=window.pageYOffset,e){var r=window.getComputedStyle(t,""),i=parseFloat(r.borderTopWidth)||0,a=parseFloat(r.borderRightWidth)||0,l=parseFloat(r.borderBottomWidth)||0,s=parseFloat(r.borderLeftWidth)||0;o.left+=s,o.top+=i,o.width-=s+a,o.height-=i+l}return jt(o)}function Wt(t,e){null==V&&(!1!==yt&&(V=I.getValue("cursor",yt)),null==V&&(V=!1)),t.style.cursor=!1===V?e:V}function Yt(t){null==q&&(!1!==vt&&(q=I.getValue("cursor",vt)),null==q&&(q=!1)),!1!==q&&(t.style.cursor=q)}function zt(t,e,n){var o=t.svgPoint;return o.x=e,o.y=n,o.matrixTransform(t.svgCtmElement.getScreenCTM().inverse())}function Ut(t,e){var n=t.elementBBox;if(e.left!==n.left||e.top!==n.top){var o=t.htmlOffset;return t.elementStyle[J]="translate(".concat(e.left+o.left,"px, ").concat(e.top+o.top,"px)"),!0}return!1}function Xt(t,e){var n=t.elementBBox,o=t.elementStyle,r=t.htmlOffset,i=!1;return e.left!==n.left&&(o.left=e.left+r.left+"px",i=!0),e.top!==n.top&&(o.top=e.top+r.top+"px",i=!0),i}function Gt(t,e){var n=t.elementBBox;if(e.left!==n.left||e.top!==n.top){var o=t.svgOffset,r=t.svgOriginBBox,i=zt(t,e.left-window.pageXOffset,e.top-window.pageYOffset);return t.svgTransform.setTranslate(i.x+o.x-r.x,i.y+o.y-r.y),!0}return!1}function Vt(t,e,n){var o=t.elementBBox;function r(){t.minLeft>=t.maxLeft?e.left=o.left:e.left<t.minLeft?e.left=t.minLeft:e.left>t.maxLeft&&(e.left=t.maxLeft),t.minTop>=t.maxTop?e.top=o.top:e.top<t.minTop?e.top=t.minTop:e.top>t.maxTop&&(e.top=t.maxTop)}if(r(),n){if(!1===n(e))return!1;r()}var i=t.moveElm(t,e);return i&&(t.elementBBox=jt({left:e.left,top:e.top,width:o.width,height:o.height})),i}function qt(t){var e=t.element,n=t.elementStyle,o=Ht(e),r=["display","marginTop","marginBottom","width","height"];r.unshift(J);var i=n[Z];n[Z]="none";var a=Ht(e);t.orgStyle?r.forEach((function(e){null!=t.lastStyle[e]&&n[e]!==t.lastStyle[e]||(n[e]=t.orgStyle[e])})):(t.orgStyle=r.reduce((function(t,e){return t[e]=n[e]||"",t}),{}),t.lastStyle={});var l=Ht(e),s=window.getComputedStyle(e,"");"inline"===s.display&&(n.display="inline-block",["Top","Bottom"].forEach((function(t){var e=parseFloat(s["padding".concat(t)]);n["margin".concat(t)]=e?"-".concat(e,"px"):"0"}))),n[J]="translate(0, 0)";var c=Ht(e),u=t.htmlOffset={left:c.left?-c.left:0,top:c.top?-c.top:0};return n[J]="translate(".concat(o.left+u.left,"px, ").concat(o.top+u.top,"px)"),["width","height"].forEach((function(o){c[o]!==l[o]&&(n[o]=l[o]+"px",(c=Ht(e))[o]!==l[o]&&(n[o]=l[o]-(c[o]-l[o])+"px")),t.lastStyle[o]=n[o]})),e.offsetWidth,n[Z]=i,a.left===o.left&&a.top===o.top||(n[J]="translate(".concat(a.left+u.left,"px, ").concat(a.top+u.top,"px)")),a}function Kt(t){var e=t.element,n=t.elementStyle,o=Ht(e),r=["position","marginTop","marginRight","marginBottom","marginLeft","width","height"],i=n[Z];n[Z]="none";var a=Ht(e);t.orgStyle?r.forEach((function(e){null!=t.lastStyle[e]&&n[e]!==t.lastStyle[e]||(n[e]=t.orgStyle[e])})):(t.orgStyle=r.reduce((function(t,e){return t[e]=n[e]||"",t}),{}),t.lastStyle={});var l=Ht(e);n.position="absolute",n.left=n.top=n.margin="0";var s=Ht(e),c=t.htmlOffset={left:s.left?-s.left:0,top:s.top?-s.top:0};return n.left=o.left+c.left+"px",n.top=o.top+c.top+"px",["width","height"].forEach((function(o){s[o]!==l[o]&&(n[o]=l[o]+"px",(s=Ht(e))[o]!==l[o]&&(n[o]=l[o]-(s[o]-l[o])+"px")),t.lastStyle[o]=n[o]})),e.offsetWidth,n[Z]=i,a.left===o.left&&a.top===o.top||(n.left=a.left+c.left+"px",n.top=a.top+c.top+"px"),a}function Zt(t){var e=t.element,n=t.svgTransform,o=e.getBoundingClientRect(),r=Ht(e);n.setTranslate(0,0);var i=t.svgOriginBBox=e.getBBox(),a=e.getBoundingClientRect(),l=zt(t,a.left,a.top),s=t.svgOffset={x:i.x-l.x,y:i.y-l.y},c=zt(t,o.left,o.top);return n.setTranslate(c.x+s.x-i.x,c.y+s.y-i.y),r}function Jt(t,e){var n=Ht(document.documentElement),o=t.elementBBox=t.initElm(t),r=t.containmentBBox=t.containmentIsBBox?$t(t.options.containment,n)||n:Ht(t.options.containment,!0);if(t.minLeft=r.left,t.maxLeft=r.right-o.width,t.minTop=r.top,t.maxTop=r.bottom-o.height,Vt(t,{left:o.left,top:o.top}),t.parsedSnapTargets){var i={x:o.width,y:o.height},a={x:t.minLeft,y:t.minTop},l={x:t.maxLeft,y:t.maxTop},s={left:"x",right:"x",x:"x",width:"x",xStart:"x",xEnd:"x",xStep:"x",top:"y",bottom:"y",y:"y",height:"y",yStart:"y",yEnd:"y",yStep:"y"},c=t.parsedSnapTargets.reduce((function(t,e){var c,u="containment"===e.base?r:n,d={x:u.left,y:u.top},f={x:u.width,y:u.height};function p(n){if(null==n.center&&(n.center=e.center),null==n.xGravity&&(n.xGravity=e.gravity),null==n.yGravity&&(n.yGravity=e.gravity),null!=n.x&&null!=n.y)n.x=Ft(n.x,d.x,f.x),n.y=Ft(n.y,d.y,f.y),n.center&&(n.x-=i.x/2,n.y-=i.y/2,n.corners=["tl"]),(n.corners||e.corners).forEach((function(e){var o=n.x-("tr"===e||"br"===e?i.x:0),r=n.y-("bl"===e||"br"===e?i.y:0);if(o>=a.x&&o<=l.x&&r>=a.y&&r<=l.y){var s={x:o,y:r},c=o-n.xGravity,u=o+n.xGravity,d=r-n.yGravity,f=r+n.yGravity;c>a.x&&(s.gravityXStart=c),u<l.x&&(s.gravityXEnd=u),d>a.y&&(s.gravityYStart=d),f<l.y&&(s.gravityYEnd=f),t.push(s)}}));else{var o=null!=n.x?"x":"y",r="x"===o?"y":"x",s="".concat(r,"Start"),c="".concat(r,"End"),u="".concat(o,"Gravity"),p=o.toUpperCase(),h=r.toUpperCase(),g="gravity".concat(p,"Start"),m="gravity".concat(p,"End"),y="gravity".concat(h,"Start"),v="gravity".concat(h,"End");if(n[o]=Ft(n[o],d[o],f[o]),n[s]=Ft(n[s],d[r],f[r]),n[c]=Ft(n[c],d[r],f[r])-i[r],n[s]>n[c]||n[s]>l[r]||n[c]<a[r])return;n.center&&(n[o]-=i[o]/2,n.sides=["start"]),(n.sides||e.sides).forEach((function(e){var d=n[o]-("end"===e?i[o]:0);if(d>=a[o]&&d<=l[o]){var f={},p=d-n[u],h=d+n[u];f[o]=d,p>a[o]&&(f[g]=p),h<l[o]&&(f[m]=h),n[s]>a[r]&&(f[y]=n[s]),n[c]<l[r]&&(f[v]=n[c]),t.push(f)}}))}}if((c=e.element?Ht(e.element):null)||e.ppBBox)e.ppBBox&&(c=$t(e.ppBBox,u)),c&&e.edges.forEach((function(t){var n=e.gravity,r=e.gravity;"outside"===t&&(n+=o.width,r+=o.height);var i=c.left-n,a=c.right+n,l=c.top-r,s=c.bottom+r,u="inside"===t?"start":"end";p({xStart:i,xEnd:a,y:c.top,sides:[u],center:!1}),p({x:c.left,yStart:l,yEnd:s,sides:[u],center:!1}),u="inside"===t?"end":"start",p({xStart:i,xEnd:a,y:c.bottom,sides:[u],center:!1}),p({x:c.right,yStart:l,yEnd:s,sides:[u],center:!1})}));else{var h=[["x","y","xStart","xEnd","xStep","yStart","yEnd","yStep"].reduce((function(t,n){return e[n]&&(t[n]=Ft(e[n],"xStep"===n||"yStep"===n?0:d[s[n]],f[s[n]])),t}),{})];["x","y"].forEach((function(t){var n="".concat(t,"Start"),o="".concat(t,"End"),r="".concat(t,"Step"),i="".concat(t,"Gravity");h=h.reduce((function(a,l){var s=l[n],c=l[o],u=l[r];if(null!=s&&null!=c&&s>=c)return a;if(null!=u){if(u<2)return a;var d=u/2;d=e.gravity>d?d:null;for(var f=s;f<=c;f+=u){var p=Object.keys(l).reduce((function(t,e){return e!==n&&e!==o&&e!==r&&(t[e]=l[e]),t}),{});p[t]=f,p[i]=d,a.push(p)}}else a.push(l);return a}),[])})),h.forEach((function(t){p(t)}))}return t}),[]);t.snapTargets=c.length?c:null}var u={},d=t.options.autoScroll;if(d){u.isWindow=d.target===window,u.target=d.target;var f="scroll"===e,p=function(t,e,n){var o,r,i,a,l={};a=e?document.documentElement:t,l.clientWidth=a.clientWidth,l.clientHeight=a.clientHeight;var s,c,u,d=0,f=0;return n||(e?(s=Bt(t,"x"),c=Bt(t,"y"),o=getComputedStyle(document.documentElement,""),r=getComputedStyle(document.body,""),d=Bt(t,"x",document.documentElement.scrollWidth+l.clientWidth+["marginLeft","marginRight","borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"].reduce((function(t,e){return t+(parseFloat(o[e])||0)+(parseFloat(r[e])||0)}),0)),f=Bt(t,"y",document.documentElement.scrollHeight+l.clientHeight+["marginTop","marginBottom","borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"].reduce((function(t,e){return t+(parseFloat(o[e])||0)+(parseFloat(r[e])||0)}),0)),Bt(t,"x",s),Bt(t,"y",c)):(s=Ct(t,"x"),c=Ct(t,"y"),i=getComputedStyle(t,""),d=Ct(t,"x",t.scrollWidth+l.clientWidth+["marginLeft","marginRight","borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"].reduce((function(t,e){return t+(parseFloat(i[e])||0)}),0)),f=Ct(t,"y",t.scrollHeight+l.clientHeight+["marginTop","marginBottom","borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"].reduce((function(t,e){return t+(parseFloat(i[e])||0)}),0)),Ct(t,"x",s),Ct(t,"y",c))),l.scrollWidth=l.clientWidth+d,l.scrollHeight=l.clientHeight+f,e?l.clientX=l.clientY=0:(u=t.getBoundingClientRect(),i||(i=getComputedStyle(t,"")),l.clientX=u.left+(parseFloat(i.borderLeftWidth)||0),l.clientY=u.top+(parseFloat(i.borderTopWidth)||0)),l}(d.target,u.isWindow,f),h=jt({left:p.clientX,top:p.clientY,width:p.clientWidth,height:p.clientHeight});f?t.autoScroll&&(u.scrollWidth=t.autoScroll.scrollWidth,u.scrollHeight=t.autoScroll.scrollHeight):(u.scrollWidth=p.scrollWidth,u.scrollHeight=p.scrollHeight),[["X","Width","left","right"],["Y","Height","top","bottom"]].forEach((function(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=(u["scroll".concat(n)]||0)-p["client".concat(n)],l=d["min".concat(e)]||0,s=ft(d["max".concat(e)])?d["max".concat(e)]:a;if(l<s&&l<a){s>a&&(s=a);for(var c=[],f=o[n.toLowerCase()],g=d.sensitivity.length-1;g>=0;g--){var m=d.sensitivity[g],y=d.speed[g];c.push({dir:-1,speed:y,position:h[r]+m}),c.push({dir:1,speed:y,position:h[i]-m-f})}u[e.toLowerCase()]={min:l,max:s,lines:c}}}))}t.autoScroll=u.x||u.y?u:null}function Qt(t){St.stop(),Wt(t.options.handle,t.orgCursor),G.style.cursor=K,!1!==t.options.zIndex&&(t.elementStyle.zIndex=t.orgZIndex),Q&&(G.style[Q]=tt);var e=D(t.element);xt&&e.remove(xt),bt&&e.remove(bt),U=null,gt.cancel(),t.onDragEnd&&t.onDragEnd({left:t.elementBBox.left,top:t.elementBBox.top})}function te(t,e){var n,o,r=t.options;function i(t,e){function n(t){return"string"==typeof t?t.replace(/[, ]+/g," ").trim().toLowerCase():null}ft(e.gravity)&&e.gravity>0&&(t.gravity=e.gravity);var o=n(e.corner);if(o){if("all"!==o){var r={},i=o.split(/\s/).reduce((function(t,e){return(e="tl"===(e=e.trim().replace(/^(.).*?-(.).*$/,"$1$2"))||"lt"===e?"tl":"tr"===e||"rt"===e?"tr":"bl"===e||"lb"===e?"bl":"br"===e||"rb"===e?"br":null)&&!r[e]&&(t.push(e),r[e]=!0),t}),[]),a=i.length;o=a?4===a?"all":i.join(" "):null}o&&(t.corner=o)}var l=n(e.side);l&&("start"===l||"end"===l||"both"===l?t.side=l:"start end"!==l&&"end start"!==l||(t.side="both")),"boolean"==typeof e.center&&(t.center=e.center);var s=n(e.edge);s&&("inside"===s||"outside"===s||"both"===s?t.edge=s:"inside outside"!==s&&"outside inside"!==s||(t.edge="both"));var c="string"==typeof e.base?e.base.trim().toLowerCase():null;return!c||"containment"!==c&&"document"!==c||(t.base=c),t}if(e.containment&&(It(e.containment)?e.containment!==r.containment&&(r.containment=e.containment,t.containmentIsBBox=!1,n=!0):(o=Mt(Pt(e.containment)))&&At(o,r.containment)&&(r.containment=o,t.containmentIsBBox=!0,n=!0)),null!=e.snap){var a=dt(e.snap)&&null!=e.snap.targets?e.snap:{targets:e.snap},l=[],s=i({targets:l},a);s.gravity||(s.gravity=20),s.corner||(s.corner="tl"),s.side||(s.side="both"),"boolean"!=typeof s.center&&(s.center=!1),s.edge||(s.edge="both"),s.base||(s.base="containment");var c=(Array.isArray(a.targets)?a.targets:[a.targets]).reduce((function(t,e){if(null==e)return t;var n,o=It(e),r=Mt(Pt(e)),a=o||r?{boundingBox:e}:dt(e)&&null==e.start&&null==e.end&&null==e.step?e:{x:e,y:e},c=[],u={},d=a.boundingBox;if(o||It(d))c.push({element:d}),u.boundingBox=d;else if(n=r||Mt(Pt(d)))c.push({ppBBox:n}),u.boundingBox=Dt(n);else{var f,p=["x","y"].reduce((function(t,e){var n,o,r,i,l=a[e];return(n=Rt(l))?(t[e]=n,u[e]=Nt(n)):(dt(l)&&(o=Rt(l.start),r=Rt(l.end),i=Rt(l.step),o&&r&&o.isRatio===r.isRatio&&o.value>=r.value&&(f=!0)),o=t["".concat(e,"Start")]=o||{value:0,isRatio:!1},r=t["".concat(e,"End")]=r||{value:1,isRatio:!0},u[e]={start:Nt(o),end:Nt(r)},i&&((i.isRatio?i.value>0:i.value>=2)?(t["".concat(e,"Step")]=i,u[e].step=Nt(i)):f=!0)),t}),{});if(f)return t;p.xStart&&!p.xStep&&p.yStart&&!p.yStep?c.push({xStart:p.xStart,xEnd:p.xEnd,y:p.yStart},{xStart:p.xStart,xEnd:p.xEnd,y:p.yEnd},{x:p.xStart,yStart:p.yStart,yEnd:p.yEnd},{x:p.xEnd,yStart:p.yStart,yEnd:p.yEnd}):c.push(p)}if(c.length){l.push(i(u,a));var h=u.corner||s.corner,g=u.side||s.side,m=u.edge||s.edge,y={gravity:u.gravity||s.gravity,base:u.base||s.base,center:"boolean"==typeof u.center?u.center:s.center,corners:"all"===h?et:h.split(" "),sides:"both"===g?nt:[g],edges:"both"===m?ot:[m]};c.forEach((function(e){["gravity","corners","sides","center","edges","base"].forEach((function(t){e[t]=y[t]})),t.push(e)}))}return t}),[]);c.length&&(r.snap=s,At(c,t.parsedSnapTargets)&&(t.parsedSnapTargets=c,n=!0))}else e.hasOwnProperty("snap")&&t.parsedSnapTargets&&(r.snap=t.parsedSnapTargets=t.snapTargets=void 0);if(e.autoScroll){var u=dt(e.autoScroll)?e.autoScroll:{target:!0===e.autoScroll?window:e.autoScroll},d={};d.target=It(u.target)?u.target:window,d.speed=[],(Array.isArray(u.speed)?u.speed:[u.speed]).every((function(t,e){return!!(e<=2&&ft(t))&&(d.speed[e]=t,!0)})),d.speed.length||(d.speed=rt);var f=Array.isArray(u.sensitivity)?u.sensitivity:[u.sensitivity];d.sensitivity=d.speed.map((function(t,e){return ft(f[e])?f[e]:it[e]})),["X","Y"].forEach((function(t){var e="min".concat(t),n="max".concat(t);ft(u[e])&&u[e]>=0&&(d[e]=u[e]),ft(u[n])&&u[n]>=0&&(!d[e]||u[n]>=d[e])&&(d[n]=u[n])})),At(d,r.autoScroll)&&(r.autoScroll=d,n=!0)}else e.hasOwnProperty("autoScroll")&&(r.autoScroll&&(n=!0),r.autoScroll=void 0);if(n&&Jt(t),It(e.handle)&&e.handle!==r.handle){r.handle&&(r.handle.style.cursor=t.orgCursor,Q&&(r.handle.style[Q]=t.orgUserSelect),gt.removeStartHandler(r.handle,t.pointerEventHandlerId));var p=r.handle=e.handle;t.orgCursor=p.style.cursor,Wt(p,t.orgCursor),Q&&(t.orgUserSelect=p.style[Q],p.style[Q]="none"),gt.addStartHandler(p,t.pointerEventHandlerId)}(ft(e.zIndex)||!1===e.zIndex)&&(r.zIndex=e.zIndex,t===U&&(t.elementStyle.zIndex=!1===r.zIndex?t.orgZIndex:r.zIndex));var h,g={left:t.elementBBox.left,top:t.elementBBox.top};ft(e.left)&&e.left!==g.left&&(g.left=e.left,h=!0),ft(e.top)&&e.top!==g.top&&(g.top=e.top,h=!0),h&&Vt(t,g),["onDrag","onMove","onDragStart","onMoveStart","onDragEnd"].forEach((function(n){"function"==typeof e[n]?(r[n]=e[n],t[n]=r[n].bind(t.ins)):e.hasOwnProperty(n)&&null==e[n]&&(r[n]=t[n]=void 0)}))}var ee=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o={ins:this,options:{zIndex:9e3},disabled:!1};if(Object.defineProperty(this,"_id",{value:++mt}),o._id=this._id,pt[this._id]=o,!It(e)||e===G)throw new Error("This element is not accepted.");if(n){if(!dt(n))throw new Error("Invalid options.")}else n={};var r,i,a=!0;if(e instanceof SVGElement&&(r=e.ownerSVGElement)){if(!e.getBBox)throw new Error("This element is not accepted. (SVGLocatable)");if(!e.transform)throw new Error("This element is not accepted. (SVGAnimatedTransformList)");o.svgTransform=e.transform.baseVal.appendItem(r.createSVGTransform()),o.svgPoint=r.createSVGPoint();var l=e.nearestViewportElement;o.svgCtmElement=st?l.appendChild(document.createElementNS(r.namespaceURI,"rect")):l,a=!1,o.initElm=Zt,o.moveElm=Gt}else{var s=I.getName("willChange");s&&(a=!1),!n.leftTop&&J?(s&&(e.style[s]="transform"),o.initElm=qt,o.moveElm=Ut):(s&&(e.style[s]="left, top"),o.initElm=Kt,o.moveElm=Xt)}o.element=function(t,e){var n=t.style;n.webkitTapHighlightColor="transparent";var o=I.getName("boxShadow"),r=window.getComputedStyle(t,"")[o];return r&&"none"!==r||(n[o]="0 0 1px transparent"),e&&J&&(n[J]="translateZ(0)"),t}(e,a),o.elementStyle=e.style,o.orgZIndex=o.elementStyle.zIndex,wt&&D(e).add(wt),o.pointerEventHandlerId=gt.regStartHandler((function(t){return n=t,!((e=o).disabled||e.onDragStart&&!1===e.onDragStart(n)||(U&&Qt(U),Yt(e.options.handle),G.style.cursor=q||window.getComputedStyle(e.options.handle,"").cursor,!1!==e.options.zIndex&&(e.elementStyle.zIndex=e.options.zIndex),Q&&(G.style[Q]="none"),bt&&D(e.element).add(bt),U=e,X=!1,ht.left=e.elementBBox.left-(n.clientX+window.pageXOffset),ht.top=e.elementBBox.top-(n.clientY+window.pageYOffset),0));var e,n})),n.containment||(n.containment=(i=e.parentNode)&&It(i)?i:G),n.handle||(n.handle=e),te(o,n)}var e,n,o;return e=t,o=[{key:"draggableCursor",get:function(){return yt},set:function(t){yt!==t&&(yt=t,V=null,Object.keys(pt).forEach((function(t){var e=pt[t];e.disabled||e===U&&!1!==q||(Wt(e.options.handle,e.orgCursor),e===U&&(G.style.cursor=K,G.style.cursor=window.getComputedStyle(e.options.handle,"").cursor))})))}},{key:"draggingCursor",get:function(){return vt},set:function(t){vt!==t&&(vt=t,q=null,U&&(Yt(U.options.handle),!1===q&&(Wt(U.options.handle,U.orgCursor),G.style.cursor=K),G.style.cursor=q||window.getComputedStyle(U.options.handle,"").cursor))}},{key:"draggableClass",get:function(){return wt},set:function(t){(t=t?t+"":void 0)!==wt&&(Object.keys(pt).forEach((function(e){var n=pt[e];if(!n.disabled){var o=D(n.element);wt&&o.remove(wt),t&&o.add(t)}})),wt=t)}},{key:"draggingClass",get:function(){return bt},set:function(t){if((t=t?t+"":void 0)!==bt){if(U){var e=D(U.element);bt&&e.remove(bt),t&&e.add(t)}bt=t}}},{key:"movingClass",get:function(){return xt},set:function(t){if((t=t?t+"":void 0)!==xt){if(U&&X){var e=D(U.element);xt&&e.remove(xt),t&&e.add(t)}xt=t}}}],(n=[{key:"remove",value:function(){var t=pt[this._id];this.disabled=!0,gt.unregStartHandler(gt.removeStartHandler(t.options.handle,t.pointerEventHandlerId)),delete pt[this._id]}},{key:"setOptions",value:function(t){return dt(t)&&te(pt[this._id],t),this}},{key:"position",value:function(){return Jt(pt[this._id]),this}},{key:"disabled",get:function(){return pt[this._id].disabled},set:function(t){var e=pt[this._id];(t=!!t)!==e.disabled&&(e.disabled=t,e.disabled?(e===U&&Qt(e),e.options.handle.style.cursor=e.orgCursor,Q&&(e.options.handle.style[Q]=e.orgUserSelect),wt&&D(e.element).remove(wt)):(Wt(e.options.handle,e.orgCursor),Q&&(e.options.handle.style[Q]="none"),wt&&D(e.element).add(wt)))}},{key:"element",get:function(){return pt[this._id].element}},{key:"rect",get:function(){return Pt(pt[this._id].elementBBox)}},{key:"left",get:function(){return pt[this._id].elementBBox.left},set:function(t){te(pt[this._id],{left:t})}},{key:"top",get:function(){return pt[this._id].elementBBox.top},set:function(t){te(pt[this._id],{top:t})}},{key:"containment",get:function(){var t=pt[this._id];return t.containmentIsBBox?Dt(t.options.containment):t.options.containment},set:function(t){te(pt[this._id],{containment:t})}},{key:"snap",get:function(){return Pt(pt[this._id].options.snap)},set:function(t){te(pt[this._id],{snap:t})}},{key:"autoScroll",get:function(){return Pt(pt[this._id].options.autoScroll)},set:function(t){te(pt[this._id],{autoScroll:t})}},{key:"handle",get:function(){return pt[this._id].options.handle},set:function(t){te(pt[this._id],{handle:t})}},{key:"zIndex",get:function(){return pt[this._id].options.zIndex},set:function(t){te(pt[this._id],{zIndex:t})}},{key:"onDrag",get:function(){return pt[this._id].options.onDrag},set:function(t){te(pt[this._id],{onDrag:t})}},{key:"onMove",get:function(){return pt[this._id].options.onMove},set:function(t){te(pt[this._id],{onMove:t})}},{key:"onDragStart",get:function(){return pt[this._id].options.onDragStart},set:function(t){te(pt[this._id],{onDragStart:t})}},{key:"onMoveStart",get:function(){return pt[this._id].options.onMoveStart},set:function(t){te(pt[this._id],{onMoveStart:t})}},{key:"onDragEnd",get:function(){return pt[this._id].options.onDragEnd},set:function(t){te(pt[this._id],{onDragEnd:t})}}])&&$(e.prototype,n),o&&$(e,o),t}();gt.addMoveHandler(document,(function(t){if(U){var e={left:t.clientX+window.pageXOffset+ht.left,top:t.clientY+window.pageYOffset+ht.top};if(Vt(U,e,U.snapTargets?function(t){var e,n=U.snapTargets.length,o=!1,r=!1;for(e=0;e<n&&(!o||!r);e++){var i=U.snapTargets[e];(null==i.gravityXStart||t.left>=i.gravityXStart)&&(null==i.gravityXEnd||t.left<=i.gravityXEnd)&&(null==i.gravityYStart||t.top>=i.gravityYStart)&&(null==i.gravityYEnd||t.top<=i.gravityYEnd)&&(o||null==i.x||(t.left=i.x,o=!0,e=-1),r||null==i.y||(t.top=i.y,r=!0,e=-1))}return t.snapped=o||r,!U.onDrag||U.onDrag(t)}:U.onDrag)){var n={},o=U.autoScroll;if(o){var r={x:U.elementBBox.left-window.pageXOffset,y:U.elementBBox.top-window.pageYOffset};["x","y"].forEach((function(t){if(o[t]){var e=o[t].min,i=o[t].max;o[t].lines.some((function(o){return(-1===o.dir?r[t]<=o.position:r[t]>=o.position)&&(n[t]={dir:o.dir,speed:o.speed/1e3,min:e,max:i},!0)}))}}))}n.x||n.y?(St.move(o.target,n,o.isWindow?Bt:Ct),e.autoScroll=!0):St.stop(),X||(X=!0,xt&&D(U.element).add(xt),U.onMoveStart&&U.onMoveStart(e)),U.onMove&&U.onMove(e)}}}));{let t=function(){U&&Qt(U)};gt.addEndHandler(document,t),gt.addCancelHandler(document,t)}{let t=function(){Z=I.getName("transitionProperty"),J=I.getName("transform"),K=G.style.cursor,(Q=I.getName("userSelect"))&&(tt=G.style[Q]);var t,e={};function n(t,e){t.initElm&&Jt(t,e)}var o=!1,r=u((function(r){o||(o=!0,U&&(n(U,r.type),gt.move(),e[U._id]=!0),clearTimeout(t),t=setTimeout((function(){var o;o=r.type,clearTimeout(t),Object.keys(pt).forEach((function(t){e[t]||n(pt[t],o)})),e={}}),200),o=!1)}));window.addEventListener("resize",r,!0),window.addEventListener("scroll",r,!0)};(G=document.body)?t():document.addEventListener("DOMContentLoaded",(function(){G=document.body,t()}),!0)}e.default=ee}]).default,a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self,{exports:{}});!function(t){var e=function(t){var e,n=Object.prototype,o=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(A){c=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),l=new B(o||[]);return r(a,"_invoke",{value:k(t,n,l)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(A){return{type:"throw",arg:A}}}t.wrap=u;var f="suspendedStart",p="executing",h="completed",g={};function m(){}function y(){}function v(){}var w={};c(w,a,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(C([])));x&&x!==n&&o.call(x,a)&&(w=x);var S=v.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function n(r,i,a,l){var s=d(t[r],t,i);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,l)}),(function(t){n("throw",t,a,l)})):e.resolve(u).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,l)}))}l(s.arg)}var i;r(this,"_invoke",{value:function(t,o){function r(){return new e((function(e,r){n(t,o,e,r)}))}return i=i?i.then(r,r):r()}})}function k(t,e,n){var o=f;return function(r,i){if(o===p)throw new Error("Generator is already running");if(o===h){if("throw"===r)throw i;return P()}for(n.method=r,n.arg=i;;){var a=n.delegate;if(a){var l=T(a,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,e,n);if("normal"===s.type){if(o=n.done?h:"suspendedYield",s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=h,n.method="throw",n.arg=s.arg)}}}function T(t,n){var o=n.method,r=t.iterator[o];if(r===e)return n.delegate=null,"throw"===o&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),g;var i=d(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function C(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function n(){for(;++r<t.length;)if(o.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}return{next:P}}function P(){return{value:e,done:!0}}return y.prototype=v,r(S,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:y,configurable:!0}),y.displayName=c(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},t.awrap=function(t){return{__await:t}},E(_.prototype),c(_.prototype,l,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,o,r,i){void 0===i&&(i=Promise);var a=new _(u(e,n,o,r),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),c(S,s,"Generator"),c(S,a,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},t.values=C,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(o,r){return l.type="throw",l.arg=t,n.next=o,r&&(n.method="next",n.arg=e),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;O(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={iterator:C(t),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=e),g}},t}(a.exports);try{regeneratorRuntime=e}catch(n){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}();var l=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`;const s=l;let c=0;var u=({id:t,action:e,payload:n={}})=>{let o=t;return void 0===o&&(o=s("Job",c),c+=1),{id:o,action:e,payload:n}},d={};let f=!1;d.logging=f,d.setLogging=t=>{f=t},d.log=(...t)=>f?console.log.apply(globalThis,t):null;const p=u,{log:h}=d,g=l;let m=0;const y=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)};var v,w={exports:{}};function b(){return v?w.exports:(v=1,w.exports=function(){function t(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var n=document.getElementsByTagName("head")[0];n.insertBefore(e,n.firstChild);for(var o,r=document.createElement("a"),i=1;i<t;i++)r.href=arguments[i],o=r.href,e.href=o;return n.removeChild(e),o}return t}())}const x="browser"===(t=>{const e={};return"undefined"!=typeof WorkerGlobalScope?e.type="webworker":y()?e.type="electron":"object"==typeof window?e.type="browser":"object"==typeof process&&(e.type="node"),void 0===t?e:e[t]})("type")?b():t=>t;var S={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};var E={defaultOEM:S.DEFAULT};const _={name:"tesseract.js",version:"4.0.2",description:"Pure Javascript Multilingual OCR",main:"src/index.js",types:"src/index.d.ts",unpkg:"dist/tesseract.min.js",jsdelivr:"dist/tesseract.min.js",scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.js","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.dev.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},browser:{"./src/worker/node/index.js":"./src/worker/browser/index.js"},author:"",contributors:["jeromewu"],license:"Apache-2.0",devDependencies:{"@babel/core":"^7.18.7","@babel/preset-env":"^7.18.7","@rollup/plugin-commonjs":"^22.0.2",acorn:"^6.4.0","babel-loader":"^8.2.0",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.2.0","eslint-config-airbnb-base":"^14.2.0","eslint-plugin-import":"^2.22.1","expect.js":"^0.3.1",express:"^4.17.1",mocha:"^10.0.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^2.7.1",rollup:"^2.79.0","wait-on":"^3.3.0",webpack:"^5.74.0","webpack-bundle-analyzer":"^4.6.0","webpack-cli":"^4.10.0","webpack-dev-middleware":"^5.3.3"},dependencies:{"babel-eslint":"^10.1.0","bmp-js":"^0.1.0","file-type":"^12.4.1","idb-keyval":"^3.2.0","is-electron":"^2.2.0","is-url":"^1.2.4","node-fetch":"^2.6.0","opencollective-postinstall":"^2.0.2","regenerator-runtime":"^0.13.3","resolve-url":"^0.2.1","tesseract.js-core":"^4.0.2","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},repository:{type:"git",url:"https://github.com/naptha/tesseract.js.git"},bugs:{url:"https://github.com/naptha/tesseract.js/issues"},homepage:"https://github.com/naptha/tesseract.js",collective:{type:"opencollective",url:"https://opencollective.com/tesseractjs"}};const k=b(),{version:T}=_;var L={...{langPath:"https://tessdata.projectnaptha.com/4.0.0",workerBlobURL:!0,logger:()=>{}},workerPath:"undefined"!=typeof process&&"development"===process.env.TESS_ENV?k(`/dist/worker.dev.js?nocache=${Math.random().toString(36).slice(3)}`):`https://unpkg.com/tesseract.js@v${T}/dist/worker.min.js`,corePath:null};const O=b(),B=t=>new Promise(((e,n)=>{const o=new FileReader;o.onload=()=>{e(o.result)},o.onerror=({target:{error:{code:t}}})=>{n(Error(`File could not be read! Code=${t}`))},o.readAsArrayBuffer(t)})),C=async t=>{let e=t;if(void 0===t)return"undefined";if("string"==typeof t)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t))e=atob(t.split(",")[1]).split("").map((t=>t.charCodeAt(0)));else{const n=await fetch(O(t));e=await n.arrayBuffer()}else t instanceof HTMLElement?("IMG"===t.tagName&&(e=await C(t.src)),"VIDEO"===t.tagName&&(e=await C(t.poster)),"CANVAS"===t.tagName&&await new Promise((n=>{t.toBlob((async t=>{e=await B(t),n()}))}))):(t instanceof File||t instanceof Blob)&&(e=await B(t));return new Uint8Array(e)};var P={defaultOptions:L,spawnWorker:({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const e=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(e))}else n=new Worker(t);return n},terminateWorker:t=>{t.terminate()},onMessage:(t,e)=>{t.onmessage=({data:t})=>{e(t)}},send:async(t,e)=>{t.postMessage(e)},loadImage:C};const A=t=>{const e={...t};return["corePath","workerPath","langPath"].forEach((n=>{t[n]&&(e[n]=x(e[n]))})),e},I=t=>{const e=[],n=[],o=[],r=[],i=[];return t.blocks&&t.blocks.forEach((a=>{a.paragraphs.forEach((e=>{e.lines.forEach((n=>{n.words.forEach((o=>{o.symbols.forEach((r=>{i.push({...r,page:t,block:a,paragraph:e,line:n,word:o})})),r.push({...o,page:t,block:a,paragraph:e,line:n})})),o.push({...n,page:t,block:a,paragraph:e})})),n.push({...e,page:t,block:a})})),e.push({...a,page:t})})),{...t,blocks:e,paragraphs:n,lines:o,words:r,symbols:i}},j=u,{log:R}=d,N=l,{defaultOEM:F}=E,{defaultOptions:M,spawnWorker:D,terminateWorker:H,onMessage:W,loadImage:Y,send:z}=P;let U=0;var X=async(t={})=>{const e=N("Worker",U),{logger:n,errorHandler:o,...r}=A({...M,...t}),i={},a={};let l,s;const c=new Promise(((t,e)=>{s=t,l=e}));let u=D(r);u.onerror=t=>{l(t.message)},U+=1;const d=(t,e)=>{i[t]=e},f=(t,e)=>{a[t]=e},p=({id:t,action:n,payload:o})=>new Promise(((r,i)=>{R(`[${e}]: Start ${t}, action=${n}`),d(n,r),f(n,i),z(u,{workerId:e,jobId:t,action:n,payload:o})}));W(u,(({workerId:t,jobId:e,status:r,action:s,data:c})=>{if("resolve"===r){R(`[${t}]: Complete ${e}`);let n=c;"recognize"===s?n=I(c):"getPDF"===s&&(n=Array.from({...c,length:Object.keys(c).length})),i[s]({jobId:e,data:n})}else if("reject"===r){if(a[s](c),"load"===s&&l(c),!o)throw Error(c);o(c)}else"progress"===r&&n({...c,userJobId:e})}));const h={id:e,worker:u,setResolve:d,setReject:f,load:()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),writeText:(t,e,n)=>p(j({id:n,action:"FS",payload:{method:"writeFile",args:[t,e]}})),readText:(t,e)=>p(j({id:e,action:"FS",payload:{method:"readFile",args:[t,{encoding:"utf8"}]}})),removeFile:(t,e)=>p(j({id:e,action:"FS",payload:{method:"unlink",args:[t]}})),FS:(t,e,n)=>p(j({id:n,action:"FS",payload:{method:t,args:e}})),loadLanguage:(t="eng",e)=>p(j({id:e,action:"loadLanguage",payload:{langs:t,options:r}})),initialize:(t="eng",e=F,n,o)=>p(j({id:o,action:"initialize",payload:{langs:t,oem:e,config:n}})),setParameters:(t={},e)=>p(j({id:e,action:"setParameters",payload:{params:t}})),recognize:async(t,e={},n={blocks:!0,text:!0,hocr:!0,tsv:!0},o)=>p(j({id:o,action:"recognize",payload:{image:await Y(t),options:e,output:n}})),getPDF:(t="Tesseract OCR Result",e=!1,n)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),p(j({id:n,action:"getPDF",payload:{title:t,textonly:e}}))),detect:async(t,e)=>p(j({id:e,action:"detect",payload:{image:await Y(t)}})),terminate:async()=>(null!==u&&(H(u),u=null),Promise.resolve())};var g;return p(j({id:g,action:"load",payload:{options:r}})).then((()=>s(h))).catch((()=>{})),c};const G=X;const V=()=>{const t=g("Scheduler",m),e={},n={};let o=[];m+=1;const r=()=>Object.keys(e).length,i=()=>{if(0!==o.length){const t=Object.keys(e);for(let r=0;r<t.length;r+=1)if(void 0===n[t[r]]){o[0](e[t[r]]);break}}};return{addWorker:n=>(e[n.id]=n,h(`[${t}]: Add ${n.id}`),h(`[${t}]: Number of workers=${r()}`),i(),n.id),addJob:async(e,...a)=>{if(0===r())throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return((e,r)=>new Promise(((a,l)=>{const s=p({action:e,payload:r});o.push((async t=>{o.shift(),n[t.id]=s;try{a(await t[e].apply(globalThis,[...r,s.id]))}catch(c){l(c)}finally{delete n[t.id],i()}})),h(`[${t}]: Add ${s.id} to JobQueue`),h(`[${t}]: JobQueue length=${o.length}`),i()})))(e,a)},terminate:async()=>{Object.keys(e).forEach((async t=>{await e[t].terminate()})),o=[]},getQueueLen:()=>o.length,getNumWorkers:r}},q=X,K={recognize:async(t,e,n)=>{const o=await G(n);return await o.loadLanguage(e),await o.initialize(e),o.recognize(t).finally((async()=>{await o.terminate()}))},detect:async(t,e)=>{const n=await G(e);return await n.loadLanguage("osd"),await n.initialize("osd"),n.detect(t).finally((async()=>{await n.terminate()}))}},Z={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},J=S,Q={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"},{setLogging:tt}=d;var et={languages:Z,OEM:J,PSM:Q,createScheduler:V,createWorker:q,setLogging:tt,...K};function nt(){$.get(at.getUrl("html/coordinateReader.html"),(function(t){$("#leftMenuPane").find("#leftMenuContent").html(t)})).done((function(){$("#uploadImg").on("change",(function(t){const e=URL.createObjectURL(t.target.files[0]);if(!window.coolPlugins.tess.images.hasOwnProperty(e)){const n=e.split("/").pop();window.coolPlugins.tess.images[n]=t.target.files[0],$("#imageArea").append(`<div id="${n}" class="coordinateContainer">\n          <div class="coordImgContainer">\n            <img id="${n}-img" src="${e}" alt="" />\n          </div>\n          <div id="${n}-coord" class="coordinates" contenteditable="true"></div>\n          <img\n            src="https://cdn-icons-png.flaticon.com/512/1828/1828843.png"\n            alt=""\n            width="15"\n            onclick="return removeCoordinateContainer(this);"\n            style="cursor: pointer;"\n          />\n        </div>`)}})),$("#btnStartOCR").on("click",(async function(){await ot()}))}))}async function ot(){window.coolPlugins.tess.worker||(window.coolPlugins.tess.worker=await async function(){return await et.createWorker({logger:t=>{$("#tessLog").append(`<p>${t.status} ${100*t.progress.toFixed(2)}%</p>`)}})}(),await async function(t){await t.loadLanguage("eng"),await t.initialize("eng")}(window.coolPlugins.tess.worker));for(const t in window.coolPlugins.tess.images){const e=window.coolPlugins.tess.images[t],{data:{text:n}}=await window.coolPlugins.tess.worker.recognize(e);n.length>0?$(`#${t}-coord`).text(n):($(`#${t}-coord`).text("No coordinates found"),$(`#${t}`).attr("data-bad-image","true"))}}async function rt(t){return await async function(t,e){if(t){const{data:{text:n}}=await t.recognize(e);return n}lt.critical("Worker not initialized")}(window.coolPlugins.tess.worker,t)}function it(){0===$("#leftMenuPane").length?$.get(at.getUrl("html/leftMenu/popup.html"),(function(t){$("body").append(t)})).done((function(){const t=$("#leftMenuPane");t&&(new i(t[0]).setOptions({handle:t.find("#leftMenuPaneTitlebar .draggable")[0]}),$(".red-close").on("click",(function(){t.hide()})),t.show(200,(function(){nt()})))})):$("#leftMenuPane").show()}const at=BF2042Portal.Plugins.getPlugin("1650e7b6-3676-4858-8c9c-95b9381b7f8c"),lt=new class{constructor(t="",n=!1){e(this,"pluginName"),e(this,"showPluginName"),this.pluginName=t,this.showPluginName=n}fancyLog(t,e){t&&console.log(`${this.showPluginName?`${this.pluginName} : `:""}%c${t}`,`color: ${e}`)}info(t){this.fancyLog(t,"#26FFDF")}warn(t){this.fancyLog(t,"#F26A1B")}critical(t){this.fancyLog(t,"#FF2C10")}}(at.manifest.name),st=new CustomEvent("flyout_show_event",{detail:!0}),ct=new CustomEvent("flyout_hide_event",{detail:!1});let ut,dt,ft,pt,ht,gt={},mt=!1;function yt(t){ht.call(this,t),window.dispatchEvent(t?st:ct)}function vt(){var t;null==pt&&(t="app-rules",new MutationObserver((function(t,e){pt=e;for(const n of t)"childList"===n.type&&(document.getElementsByTagName("app-blockly").length||mt&&(mt=!1,e.disconnect(),pt=void 0,lt.warn("DOM recreated.... waiting to reload blockly specific plugins....")))})).observe("string"==typeof t?$(t)[0]:t,{childList:!0,subtree:!0})),mt=!0}function wt(){mt=!1,lt.info("\r\n\r\n   _____            _   _____  _             _           \r\n  / ____|          | | |  __ \\| |           (_)          \r\n | |     ___   ___ | | | |__) | |_   _  __ _ _ _ __  ___ \r\n | |    / _ \\ / _ \\| | |  ___/| | | | |/ _` | | '_ \\/ __|\r\n | |___| (_) | (_) | | | |    | | |_| | (_| | | | | \\__ \\\r\n  \\_____\\___/ \\___/|_| |_|    |_|\\__,_|\\__, |_|_| |_|___/\r\n                                        __/ |            \r\n                                       |___/             \r\n\n              Adding spice to your logic editor"),lt.info("Setting Global Plugins Base variables..."),at.initializeWorkspace=function(){if(!mt)try{!function(){if(lt.info("Setting Blockly Plugins Base variables..."),ut=_Blockly,dt=ut.getMainWorkspace()||void 0,dt){ft=_Blockly.getMainWorkspace().getBlocksByType("modBlock",!1)[0],gt={},dt.getToolbox().toolboxDef_.contents.forEach((t=>{"SEP"===t.kind||["SEARCH RESULTS","VARIABLES","SUBROUTINES","CONTROL ACTIONS"].includes(t.name)||t.contents.forEach((e=>{"LABEL"!==e.kind&&(t.name in gt?gt[t.name].push(e):gt[t.name]=[e])}))}));let t=dt.getFlyout();ht=t.setVisible,t.setVisible=yt,window.modBlock=ft,window.allBlocks=gt,window.mainWorkspace=dt,window.startTess=ot,window.tessOCR=rt,window.loadCoordinateReader=nt,window.coolPlugins={tess:{scheduler:void 0,worker:void 0,images:{}}},window.Blockly=ut}}(),dt&&(r(),function(){lt.info("Initializing left plugins menu");const t=$("app-editor-menu mat-tree");t?0===$("#cool_leftMenuButton").length?$.get(at.getUrl("html/leftMenuButton.html"),(function(e){t.append(e)})).done((function(){const t=$("#cool_leftMenuButtonImage");t&&(t.attr("src",at.getUrl("static/images/leftMenuButton.svg")),$("#cool_leftMenuButton").on("click",it))})):lt.warn("Left Menu Button already exists"):lt.critical("Couldn't find root menu tree")}(),lt.info("loading searchWithCategory plugin...."),$("input.searchbar").remove().clone().appendTo("span.searchbarspan").on("keyup",(function(t){setTimeout((function(){const t=window.mainWorkspace.getToolbox(),e=t.getToolboxItems()[0],n=$("input.searchbar").val().trim();if(n.length){let o=[],r=[];for(const[t,e]of Object.entries(window.allBlocks)){r=[];const i={kind:"LABEL",text:t};r.push(i),e.forEach((t=>{t.displayName.toLowerCase().includes(n.toLowerCase())&&r.push(t)})),r.length>1&&(o=o.concat(r))}e.updateFlyoutContents(o),e.show(),t.setSelectedItem(e)}else e.hide()}))}))),vt()}catch(t){lt.critical("Failed loading plugin... "+t)}},lt.info("coolnesss loaded"),window.cool_plugin_loaded=!0}!function(){if(void 0===window.jQuery){const t=document.createElement("script");t.src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js",t.type="text/javascript",t.addEventListener("load",(()=>{console.log(`jQuery ${$.fn.jquery} has been loaded successfully!`),wt()})),document.head.appendChild(t)}else wt()}();
